let e=0;function d(e,d){let t={};return m.Animations.forEach(u=>{t[u]={numFrames:d,prefix:`${e}_${u}`}}),t}function t({x:e,y:d,z:t,radius:u,scale:a=3,name:o,framerate:r=4/60,animations:i,suffix:s=""}={}){let n={};return Object.keys(i).forEach(e=>{n[e]={framerate:r,frames:Array.from({length:i[e].numFrames},(d,t)=>`${i[e].prefix}${s||t}`),loop:!0}}),Unicorn.AddObject(o,{type:"circle",scale:{x:a,y:a},friction:0,frictionAir:0,frictionStatic:0,bounce:1,animations:n,x:e,y:d,z:t,radius:u})}function u({x:e,y:d,z:t,scale:u=3,name:a,framerate:o=4/60,animations:r,suffix:i=""}={}){let s={};return Object.keys(r).forEach(e=>{s[e]={framerate:o,frames:Array.from({length:r[e].numFrames},(d,t)=>`${r[e].prefix}${i||t}`),loop:!0}}),Unicorn.AddSprite(a,{scale:{x:u,y:u},animations:s,x:e,y:d,z:t})}const a="https://api.pixelplush.dev/v1";let o="PixelPlush Game",r="unknown",i={},s={},n="",c=1920,f=1080,l=.5;const m={NumFrames:10,Animations:["front","left","back","right"]};let p={};var h="",y=!0;let g="",b=!0,_={};function v(e){return Math.floor(Math.random()*Math.floor(e))}function x(e){for(let d=e.length-1;d>0;d--){const t=Math.floor(Math.random()*(d+1));[e[d],e[t]]=[e[t],e[d]]}}async function S(e){let d=Object.keys(ee).length;return fetch(a+"/analytics/heartbeat",{method:"POST",body:JSON.stringify({session:h,game:r,theme:o,channel:s.channel,players:Object.keys(ee),count:d})}).then(e=>e.json())}function A(e,d,t,u,a=""){if(!p[e+a]){p[e+a]=!0;for(let o=0;o<u;o++)for(let u=0;u<m.Animations.length;u++){const r=m.Animations[u],i=`${t}_${r}`;a?Unicorn.Load(`${e}_${r}${a}`,`${n}/assets/${d}/${e}/${i}/${i}${a}.png`):Unicorn.Load(`${e}_${r}${o}`,`${n}/assets/${d}/${e}/${i}/${i}${o+1}.png`)}}}window.setupGame=function(e,d,t){if(o=e,i=d,s=t,n=i.path||"",s.clouds=void 0===s.clouds||null===s.clouds?!s.overlay:"true"===s.clouds,l=void 0===s.volume||null===s.volume?0:parseInt(s.volume)/100,c=Math.min(window.innerWidth,1920),f=Math.min(window.innerHeight,1080),s.variations&&!s.didRandom){const e=s.variations.split(","),d=v(e.length),t=`${window.location.protocol}//${window.location.host}${window.location.pathname.substr(0,window.location.pathname.lastIndexOf("/"))}/${e[d]}${window.location.search}&didRandom=1`;window.location.href=t}s.readyTime&&(b=!1,setTimeout(()=>{b=!0,ComfyJS.Say("Parachute Drop is ready!")},parseInt(s.readyTime||1e3)))},window.WebFontConfig={custom:{families:["Pixeltype"]},active(){!async function(){if(document.hidden)return void document.addEventListener("visibilitychange",()=>{location.reload()},!1);try{const e=(await fetch("https://www.pixelplush.dev/assets/shamelist.txt").then(e=>e.text())).split(",").map(e=>e.trim().toLowerCase());if(s.channel&&e&&e.includes(s.channel.toLowerCase())&&(console.log("This channel has been blocked for violating the PixelPlush Terms of Service."),y=!1),i.requires)try{if(account=await fetch(a+"/accounts",{headers:{Twitch:s.oauth?s.oauth.replace("oauth:",""):void 0}}).then(e=>e.json()),console.log(account),account.error)throw"Login Error";if(!account.owned.includes(i.requires))throw"Item not owned"}catch(e){return void console.log("Auth Validate Failed",e)}!async function(){r="plinko",s.notifVolume&&(C=parseInt(s.notifVolume)/100);s.cpPlink&&(_["Plinko!"]={desc:"Drop into the PixelPlush Plinko Game!",color:"#F2C079",cost:parseInt(s.cpPlinkCost||50),callback:(e,d,t,u,a)=>{b&&(y?(z&&s.hideTilStart&&(z=!1,ue.forEach(e=>e.visible=!0),oe.forEach(e=>e.sprite.visible=!0),i.hideWalls||(re.forEach(e=>e.sprite.visible=!0),Array.isArray(se)?se[ne].visible=!0:se.visible=!0,ie&&(ie.visible=!0)),i.target&&(Array.isArray(X)?(X[Q].visible=!0,i.target_animate_on_landed||L()):X.visible=!0,Array.isArray(Y)?(Y[H].visible=!0,i.target_animate_on_landed||L()):Y.visible=!0,V&&(V.visible=!0))),N?F.push({username:a.username,name:e,color:a.userColor||"#ffffff",message:u,emote:a.messageEmotes?Object.keys(a.messageEmotes)[0]:"",emoji:"",extra:a}):ye(a.username,e,a.userColor||"#ffffff",u,a.messageEmotes?Object.keys(a.messageEmotes)[0]:"")):s.oauth&&ComfyJS.Say("The Plinko Bounce game needs your attention. Please contact the PixelPlush team on Discord."))}});s.cpQueue&&(_["Group Plinko"]={desc:"Queue everyone for a group plinko in the PixelPlush Plinko Game!",color:"#F2C079",cost:parseInt(s.cpQueueCost||500),cooldown:parseInt(s.cpQueueCD||120),callback:()=>{if(b)if(y)if(N)ComfyJS.Say("/me Group Plinko is already queued.");else{C&&Unicorn.PlaySound("sfx-group-queue",{volume:C}),N=!0,Object.keys(ee).forEach(e=>{Unicorn.RemoveObject(ee[e].player.charName),ee[e].pet&&Unicorn.RemoveObject(ee[e].pet.charName),Unicorn.RemoveText("name_"+e),delete ee[e]}),B&&clearTimeout(B);const e=6e4;ComfyJS.Say(`/me Plinkos are queued for the next 60 seconds. !${s.command||"plinko"} to join!`),setTimeout(()=>{ComfyJS.Say(`/me 30 seconds remaining. !${s.command||"plinko"} to join!`)},e-3e4),setTimeout(()=>{ComfyJS.Say("/me 10 seconds. !"+(s.command||"plinko"))},e-1e4),setTimeout(()=>{x(F),F.forEach(e=>{ye(e.username,e.name,e.color,e.message,e.emote,e.emoji,e.extra)}),F=[]},e)}else s.oauth&&ComfyJS.Say("The Plinko Bounce game needs your attention. Please contact the PixelPlush team on Discord.")}})}()}catch(e){console.log(e)}Unicorn.Create("unicorn-display",{width:c,height:f,background:"transparent",init:ge,update:be,channel:s.channel,username:s.oauth?s.channel:void 0,password:s.oauth?s.oauth.replace("oauth:",""):void 0,onCommand:R,onChat:J,screenWalls:!1,gravity:{x:0,y:1}}),ComfyJS.onCheer=q,ComfyJS.onConnected=async(e,d,t)=>{if(t){!function(){D=i.target_width||368,W=c/2,G=f-47+(i.target_offset||0),i.target_walls&&(W<D/2+70?W=D/2+70:W>c-D/2-70&&(W=c-D/2-70));if(i.target_versions){const e=v(Object.keys(i.target_versions).length);Object.keys(i.target_versions).forEach((d,t)=>{e===t&&(Z=d);let u=i.target_versions[d];if(K[d]={},Array.isArray(u.target))if(i.target_random){let e=v(u.target.length);X=Unicorn.AddBacklay("target"+d+e,"target"+d+e,W,G,{scale:{x:2,y:2}}),X.zIndex=10,X.anchor.set(.5),X.visible=!1,K[d].target=X}else{Q=0,X=[];for(let e=0;e<u.target.length;e++){let t=Unicorn.AddBacklay("target"+d+e,"target"+d+e,W,G,{scale:{x:2,y:2}});t.zIndex=10,t.anchor.set(.5),t.visible=!1,X.push(t)}K[d].target=X,X[Q].visible=!1,s.hideTilDrop||i.target_animate_on_landed||L()}else X=Unicorn.AddBacklay("target"+d,"target"+d,W,G,{scale:{x:2,y:2}}),X.zIndex=10,X.anchor.set(.5),X.visible=!1,K[d].target=X;if(u.target_overlay)if(Array.isArray(u.target_overlay)){H=0,Y=[];for(let e=0;e<u.target_overlay.length;e++){let t=Unicorn.AddBacklay("target_overlay"+d+e,"target_overlay"+d+e,W,G,{scale:{x:2,y:2}});t.zIndex=11,t.anchor.set(.5),t.visible=!1,Y.push(t)}K[d].target_overlay=Y,Y[H].visible=!1,s.hideTilDrop||i.target_animate_on_landed||L()}else Y=Unicorn.AddBacklay("target_overlay"+d,"target_overlay"+d,W,G,{scale:{x:2,y:2}}),Y.zIndex=11,Y.anchor.set(.5),Y.visible=!1,K[d].target_overlay=Y})}else if(i.target){if(Array.isArray(i.target))if(i.target_random){let e=v(i.target.length);X=Unicorn.AddBacklay("target"+e,"target"+e,W,G,{scale:{x:2,y:2}}),X.zIndex=10,X.anchor.set(.5)}else{Q=0,X=[];for(let e=0;e<i.target.length;e++){let d=Unicorn.AddBacklay("target"+e,"target"+e,W,G,{scale:{x:2,y:2}});d.zIndex=10,d.anchor.set(.5),d.visible=!1,X.push(d)}X[Q].visible=!0,s.hideTilDrop||i.target_animate_on_landed||L()}else X=Unicorn.AddBacklay("target","target",W,G,{scale:{x:2,y:2}}),X.zIndex=10,X.anchor.set(.5);if(i.target_overlay)if(Array.isArray(i.target_overlay)){H=0,Y=[];for(let e=0;e<i.target_overlay.length;e++){let d=Unicorn.AddBacklay("target_overlay"+e,"target_overlay"+e,W,G,{scale:{x:2,y:2}});d.zIndex=11,d.anchor.set(.5),d.visible=!1,Y.push(d)}Y[H].visible=!0,s.hideTilDrop||i.target_animate_on_landed||L()}else Y=Unicorn.AddBacklay("target_overlay","target_overlay",W,G,{scale:{x:2,y:2}}),Y.zIndex=11,Y.anchor.set(.5)}i.target_front&&(V=Unicorn.AddOverlay("target_front","target_front",W,G,{scale:{x:2,y:2}}),V.anchor.set(.5));if(s.clouds)for(let e=0;e<11;e++){M++;let e=i.clouds[v(i.clouds.length)],d=Unicorn.AddOverlay("cloud_"+M,e,v(c),v(500),{scale:{x:3,y:3}});d.alpha=s.overlay?.5:.9,d.anchor.set(.5),d.speed=.01+.1*Math.random(),d.zIndex=d.speed,ue.push(d)}s.hideTilStart&&(ue.forEach(e=>e.visible=!1),oe.forEach(e=>e.sprite.visible=!1),re.forEach(e=>e.sprite.visible=!1),Array.isArray(se)?se.forEach(e=>e.visible=!1):se.visible=!1,ie&&(ie.visible=!1));i.target_walls&&(Unicorn.AddObject("TargetTop",{type:"rectangle",x:W,y:G+i.target_walls/2+i.target_collide_land,width:D-50,height:10,isStatic:!0}).sprite.visible=!1,Unicorn.AddObject("TargetLeft",{type:"rectangle",x:W-D/2+27,y:G+i.target_walls,width:10,height:100,isStatic:!0}).sprite.visible=!1,Unicorn.AddObject("TargetRight",{type:"rectangle",x:W+D/2-27,y:G+i.target_walls,width:10,height:100,isStatic:!0}).sprite.visible=!1)}();let e=await S();if(0!==e&&(h=e.session,setInterval(()=>{S()},6e4)),s.oauth){let e=await async function(e){return await fetch("https://id.twitch.tv/oauth2/validate",{headers:{Authorization:"OAuth "+e}}).then(e=>e.json()).catch(e=>({error:e}))}(s.oauth.replace("oauth:",""));g=e.client_id,["user:read:email","chat:read","chat:edit","channel:manage:redemptions","channel:read:redemptions"].every(d=>e.scopes.includes(d))||console.log("Need more permissions"),e.expires_in<1800&&console.log("Token expires soon. Need to generate new link")}let d=await ComfyJS.GetChannelRewards(g,!0),t=Object.keys(_);for(let e=0;e<t.length;e++){let u=t[e];if(!d.some(e=>e.title===u))try{await ComfyJS.CreateChannelReward(g,{title:u,prompt:_[u].desc,cost:_[u].cost,is_enabled:!0,background_color:_[u].color,is_user_input_required:!1,is_max_per_stream_enabled:!1,max_per_stream:0,is_max_per_user_per_stream_enabled:!1,max_per_user_per_stream:0,is_global_cooldown_enabled:!!_[u].cooldown,global_cooldown_seconds:_[u].cooldown,should_redemptions_skip_request_queue:!0})}catch(e){console.log(e)}}}},ComfyJS.onReward=(e,d,t,u,a)=>{_[d]&&_[d].callback(e,d,t,u,a)}}()}},function(){const e=document.createElement("script");e.src=("https:"===document.location.protocol?"https":"http")+"://ajax.googleapis.com/ajax/libs/webfont/1/webfont.js",e.type="text/javascript",e.async="true";const d=document.getElementsByTagName("script")[0];d.parentNode.insertBefore(e,d)}();const w={parse:function(e,d){var t=d&&d.assetType?d.assetType:"svg",u=d&&d.buildUrl?d.buildUrl:function(e,d){return"png"===d?"https://twemoji.maxcdn.com/2/72x72/"+e+".png":"https://twemoji.maxcdn.com/2/svg/"+e+".svg"},a=[];$.default.lastIndex=0;for(;;){var o=$.default.exec(e);if(!o)break;var r=o[0],i=T(E(r)).join("-");a.push({url:i?u(i,t):"",indices:[o.index,$.default.lastIndex],text:r,type:k})}return a}};w.toCodePoints=T;var U,$=(U=/(?:\ud83d\udc68\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c\udffb|\ud83d\udc68\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc]|\ud83d\udc68\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd]|\ud83d\udc68\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffc-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffd-\udfff]|\ud83d\udc69\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c\udffb|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb\udffc\udffe\udfff]|\ud83d\udc69\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb\udffc]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffd\udfff]|\ud83d\udc69\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffd]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc68\ud83c[\udffb-\udffe]|\ud83d\udc69\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83d\udc69\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udffb\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c\udffb|\ud83e\uddd1\ud83c\udffc\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb\udffc]|\ud83e\uddd1\ud83c\udffd\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffd]|\ud83e\uddd1\ud83c\udffe\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udffe]|\ud83e\uddd1\ud83c\udfff\u200d\ud83e\udd1d\u200d\ud83e\uddd1\ud83c[\udffb-\udfff]|\ud83e\uddd1\u200d\ud83e\udd1d\u200d\ud83e\uddd1|\ud83d\udc6b\ud83c[\udffb-\udfff]|\ud83d\udc6c\ud83c[\udffb-\udfff]|\ud83d\udc6d\ud83c[\udffb-\udfff]|\ud83d[\udc6b-\udc6d])|(?:\ud83d[\udc68\udc69])(?:\ud83c[\udffb-\udfff])?\u200d(?:\u2695\ufe0f|\u2696\ufe0f|\u2708\ufe0f|\ud83c[\udf3e\udf73\udf93\udfa4\udfa8\udfeb\udfed]|\ud83d[\udcbb\udcbc\udd27\udd2c\ude80\ude92]|\ud83e[\uddaf-\uddb3\uddbc\uddbd])|(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75]|\u26f9)((?:\ud83c[\udffb-\udfff]|\ufe0f)\u200d[\u2640\u2642]\ufe0f)|(?:\ud83c[\udfc3\udfc4\udfca]|\ud83d[\udc6e\udc71\udc73\udc77\udc81\udc82\udc86\udc87\ude45-\ude47\ude4b\ude4d\ude4e\udea3\udeb4-\udeb6]|\ud83e[\udd26\udd35\udd37-\udd39\udd3d\udd3e\uddb8\uddb9\uddcd-\uddcf\uddd6-\udddd])(?:\ud83c[\udffb-\udfff])?\u200d[\u2640\u2642]\ufe0f|(?:\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d\udc8b\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\u2764\ufe0f\u200d\ud83d\udc68|\ud83d\udc68\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc68\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc68\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\u2764\ufe0f\u200d\ud83d[\udc68\udc69]|\ud83d\udc69\u200d\ud83d\udc66\u200d\ud83d\udc66|\ud83d\udc69\u200d\ud83d\udc67\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83c\udff3\ufe0f\u200d\u26a7\ufe0f|\ud83c\udff3\ufe0f\u200d\ud83c\udf08|\ud83c\udff4\u200d\u2620\ufe0f|\ud83d\udc15\u200d\ud83e\uddba|\ud83d\udc41\u200d\ud83d\udde8|\ud83d\udc68\u200d\ud83d[\udc66\udc67]|\ud83d\udc69\u200d\ud83d[\udc66\udc67]|\ud83d\udc6f\u200d\u2640\ufe0f|\ud83d\udc6f\u200d\u2642\ufe0f|\ud83e\udd3c\u200d\u2640\ufe0f|\ud83e\udd3c\u200d\u2642\ufe0f|\ud83e\uddde\u200d\u2640\ufe0f|\ud83e\uddde\u200d\u2642\ufe0f|\ud83e\udddf\u200d\u2640\ufe0f|\ud83e\udddf\u200d\u2642\ufe0f)|[#*0-9]\ufe0f?\u20e3|(?:[Â©Â®\u2122\u265f]\ufe0f)|(?:\ud83c[\udc04\udd70\udd71\udd7e\udd7f\ude02\ude1a\ude2f\ude37\udf21\udf24-\udf2c\udf36\udf7d\udf96\udf97\udf99-\udf9b\udf9e\udf9f\udfcd\udfce\udfd4-\udfdf\udff3\udff5\udff7]|\ud83d[\udc3f\udc41\udcfd\udd49\udd4a\udd6f\udd70\udd73\udd76-\udd79\udd87\udd8a-\udd8d\udda5\udda8\uddb1\uddb2\uddbc\uddc2-\uddc4\uddd1-\uddd3\udddc-\uddde\udde1\udde3\udde8\uddef\uddf3\uddfa\udecb\udecd-\udecf\udee0-\udee5\udee9\udef0\udef3]|[\u203c\u2049\u2139\u2194-\u2199\u21a9\u21aa\u231a\u231b\u2328\u23cf\u23ed-\u23ef\u23f1\u23f2\u23f8-\u23fa\u24c2\u25aa\u25ab\u25b6\u25c0\u25fb-\u25fe\u2600-\u2604\u260e\u2611\u2614\u2615\u2618\u2620\u2622\u2623\u2626\u262a\u262e\u262f\u2638-\u263a\u2640\u2642\u2648-\u2653\u2660\u2663\u2665\u2666\u2668\u267b\u267f\u2692-\u2697\u2699\u269b\u269c\u26a0\u26a1\u26a7\u26aa\u26ab\u26b0\u26b1\u26bd\u26be\u26c4\u26c5\u26c8\u26cf\u26d1\u26d3\u26d4\u26e9\u26ea\u26f0-\u26f5\u26f8\u26fa\u26fd\u2702\u2708\u2709\u270f\u2712\u2714\u2716\u271d\u2721\u2733\u2734\u2744\u2747\u2757\u2763\u2764\u27a1\u2934\u2935\u2b05-\u2b07\u2b1b\u2b1c\u2b50\u2b55\u3030\u303d\u3297\u3299])(?:\ufe0f|(?!\ufe0e))|(?:(?:\ud83c[\udfcb\udfcc]|\ud83d[\udd74\udd75\udd90]|[\u261d\u26f7\u26f9\u270c\u270d])(?:\ufe0f|(?!\ufe0e))|(?:\ud83c[\udf85\udfc2-\udfc4\udfc7\udfca]|\ud83d[\udc42\udc43\udc46-\udc50\udc66-\udc69\udc6e\udc70-\udc78\udc7c\udc81-\udc83\udc85-\udc87\udcaa\udd7a\udd95\udd96\ude45-\ude47\ude4b-\ude4f\udea3\udeb4-\udeb6\udec0\udecc]|\ud83e[\udd0f\udd18-\udd1c\udd1e\udd1f\udd26\udd30-\udd39\udd3d\udd3e\uddb5\uddb6\uddb8\uddb9\uddbb\uddcd-\uddcf\uddd1-\udddd]|[\u270a\u270b]))(?:\ud83c[\udffb-\udfff])?|(?:\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc65\udb40\udc6e\udb40\udc67\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc73\udb40\udc63\udb40\udc74\udb40\udc7f|\ud83c\udff4\udb40\udc67\udb40\udc62\udb40\udc77\udb40\udc6c\udb40\udc73\udb40\udc7f|\ud83c\udde6\ud83c[\udde8-\uddec\uddee\uddf1\uddf2\uddf4\uddf6-\uddfa\uddfc\uddfd\uddff]|\ud83c\udde7\ud83c[\udde6\udde7\udde9-\uddef\uddf1-\uddf4\uddf6-\uddf9\uddfb\uddfc\uddfe\uddff]|\ud83c\udde8\ud83c[\udde6\udde8\udde9\uddeb-\uddee\uddf0-\uddf5\uddf7\uddfa-\uddff]|\ud83c\udde9\ud83c[\uddea\uddec\uddef\uddf0\uddf2\uddf4\uddff]|\ud83c\uddea\ud83c[\udde6\udde8\uddea\uddec\udded\uddf7-\uddfa]|\ud83c\uddeb\ud83c[\uddee-\uddf0\uddf2\uddf4\uddf7]|\ud83c\uddec\ud83c[\udde6\udde7\udde9-\uddee\uddf1-\uddf3\uddf5-\uddfa\uddfc\uddfe]|\ud83c\udded\ud83c[\uddf0\uddf2\uddf3\uddf7\uddf9\uddfa]|\ud83c\uddee\ud83c[\udde8-\uddea\uddf1-\uddf4\uddf6-\uddf9]|\ud83c\uddef\ud83c[\uddea\uddf2\uddf4\uddf5]|\ud83c\uddf0\ud83c[\uddea\uddec-\uddee\uddf2\uddf3\uddf5\uddf7\uddfc\uddfe\uddff]|\ud83c\uddf1\ud83c[\udde6-\udde8\uddee\uddf0\uddf7-\uddfb\uddfe]|\ud83c\uddf2\ud83c[\udde6\udde8-\udded\uddf0-\uddff]|\ud83c\uddf3\ud83c[\udde6\udde8\uddea-\uddec\uddee\uddf1\uddf4\uddf5\uddf7\uddfa\uddff]|\ud83c\uddf4\ud83c\uddf2|\ud83c\uddf5\ud83c[\udde6\uddea-\udded\uddf0-\uddf3\uddf7-\uddf9\uddfc\uddfe]|\ud83c\uddf6\ud83c\udde6|\ud83c\uddf7\ud83c[\uddea\uddf4\uddf8\uddfa\uddfc]|\ud83c\uddf8\ud83c[\udde6-\uddea\uddec-\uddf4\uddf7-\uddf9\uddfb\uddfd-\uddff]|\ud83c\uddf9\ud83c[\udde6\udde8\udde9\uddeb-\udded\uddef-\uddf4\uddf7\uddf9\uddfb\uddfc\uddff]|\ud83c\uddfa\ud83c[\udde6\uddec\uddf2\uddf3\uddf8\uddfe\uddff]|\ud83c\uddfb\ud83c[\udde6\udde8\uddea\uddec\uddee\uddf3\uddfa]|\ud83c\uddfc\ud83c[\uddeb\uddf8]|\ud83c\uddfd\ud83c\uddf0|\ud83c\uddfe\ud83c[\uddea\uddf9]|\ud83c\uddff\ud83c[\udde6\uddf2\uddfc]|\ud83c[\udccf\udd8e\udd91-\udd9a\udde6-\uddff\ude01\ude32-\ude36\ude38-\ude3a\ude50\ude51\udf00-\udf20\udf2d-\udf35\udf37-\udf7c\udf7e-\udf84\udf86-\udf93\udfa0-\udfc1\udfc5\udfc6\udfc8\udfc9\udfcf-\udfd3\udfe0-\udff0\udff4\udff8-\udfff]|\ud83d[\udc00-\udc3e\udc40\udc44\udc45\udc51-\udc65\udc6a-\udc6d\udc6f\udc79-\udc7b\udc7d-\udc80\udc84\udc88-\udca9\udcab-\udcfc\udcff-\udd3d\udd4b-\udd4e\udd50-\udd67\udda4\uddfb-\ude44\ude48-\ude4a\ude80-\udea2\udea4-\udeb3\udeb7-\udebf\udec1-\udec5\uded0-\uded2\uded5\udeeb\udeec\udef4-\udefa\udfe0-\udfeb]|\ud83e[\udd0d\udd0e\udd10-\udd17\udd1d\udd20-\udd25\udd27-\udd2f\udd3a\udd3c\udd3f-\udd45\udd47-\udd71\udd73-\udd76\udd7a-\udda2\udda5-\uddaa\uddae-\uddb4\uddb7\uddba\uddbc-\uddca\uddd0\uddde-\uddff\ude70-\ude73\ude78-\ude7a\ude80-\ude82\ude90-\ude95]|[\u23e9-\u23ec\u23f0\u23f3\u267e\u26ce\u2705\u2728\u274c\u274e\u2753-\u2755\u2795-\u2797\u27b0\u27bf\ue50a])|\ufe0f/g)&&U.__esModule?U:{default:U};var k=w.TypeName="emoji";var j=/\uFE0F/g,O=String.fromCharCode(8205),E=function(e){return e.indexOf(O)<0?e.replace(j,""):e};function T(e){for(var d=[],t=0,u=0,a=0;a<e.length;)t=e.charCodeAt(a++),u?(d.push((65536+(u-55296<<10)+(t-56320)).toString(16)),u=0):t>55296&&t<=56319?u=t:d.push(t.toString(16));return d}let C=0,I=null,P=0;function L(e=0){if(I&&clearInterval(I),i.target_versions){Object.keys(K).forEach(e=>{Array.isArray(X)?K[e].target.forEach(e=>{e.visible=!1}):K[e].target.visible=!1,K[e].target_overlay.forEach(e=>{e.visible=!1})});const e=v(Object.keys(K).length);Z=Object.keys(K)[e],X=K[Z].target,Y=K[Z].target_overlay,Array.isArray(X)?X[Q].visible=!0:X.visible=!0,Y[H].visible=!0}I=setInterval(()=>{Array.isArray(X)&&(X[Q].visible=!1,Q=(Q+1)%X.length,X[Q].visible=!0),Y&&Array.isArray(Y)&&(Y[H].visible=!1,H=(H+1)%Y.length,Y[H].visible=!0)},60),e>0&&(P=1e3*e)}let M=0,z=!0,F=[],N=!1;async function R(e,d,t,u,a){if(!u.broadcaster&&!u.mod||"resetplinko"!==d&&"resetboing"!==d||location.reload(),(u.broadcaster||u.mod)&&("deleteplinko"===d||"deleteboing"===d)){let e=await ComfyJS.GetChannelRewards(g,!0),d=Object.keys(_);for(let t=0;t<d.length;t++){let u=d[t],a=e.find(e=>e.title===u);a&&await ComfyJS.DeleteChannelReward(g,a.id)}}if((u.broadcaster||u.mod)&&"unqueueplinko"===d&&N&&(ComfyJS.Say("/me Group plinko is no longer queued."),N=!1),(u.broadcaster||u.mod)&&"queueplinko"===d&&(N?ComfyJS.Say("/me Group plinko is already queued."):(N=!0,Object.keys(ee).forEach(e=>{Unicorn.RemoveObject(ee[e].player.charName),ee[e].pet&&Unicorn.RemoveObject(ee[e].pet.charName),Unicorn.RemoveText("name_"+e),delete ee[e]}),B&&clearTimeout(B),ComfyJS.Say("/me Plinkos are queued this game. !startplinko to activate!"))),(u.broadcaster||u.mod)&&"startplinko"===d&&N&&(x(F),F.forEach(e=>{ye(e.username,e.name,e.color,e.message,e.emote,e.emoji,e.extra)}),F=[]),(u.broadcaster||u.mod)&&"testplinko"===d)for(var o=0;o<50;o++)M++,ye("test"+M,"test_"+M,a.userColor||"#ffffff",Object.keys(i.characters)[v(Object.keys(i.characters).length)]);let r=!1;if(!s.commandOn&&s.cpPlink||!s.command||d!==s.command||(r=!0),!s.commandOn&&s.cpPlink||s.command||"plink"!==d&&"plinko"!==d&&"boing"!==d&&"boingboing"!==d||(r=!0),b)if(y){if(r){z&&s.hideTilStart&&(z=!1,ue.forEach(e=>e.visible=!0),oe.forEach(e=>e.sprite.visible=!0),i.hideWalls||(re.forEach(e=>e.sprite.visible=!0),Array.isArray(se)?se[ne].visible=!0:se.visible=!0,ie&&(ie.visible=!0)),i.target&&(Array.isArray(X)?(X[Q].visible=!0,i.target_animate_on_landed||L()):X.visible=!0,Array.isArray(Y)?(Y[H].visible=!0,i.target_animate_on_landed||L()):Y.visible=!0,V&&(V.visible=!0)));const d=w.parse(t,{assetType:"png"});!a.messageEmotes&&d.length>0?N?F.push({username:a.username,name:e,color:a.userColor||"#ffffff",message:t,emote:"",emoji:d[0].url,extra:a}):ye(a.username,e,a.userColor||"#ffffff",t,"",d[0].url):N?F.push({username:a.username,name:e,color:a.userColor||"#ffffff",message:t,emote:a.messageEmotes?Object.keys(a.messageEmotes)[0]:"",emoji:"",extra:a}):ye(a.username,e,a.userColor||"#ffffff",t,a.messageEmotes?Object.keys(a.messageEmotes)[0]:"")}}else r&&s.oauth&&ComfyJS.Say("The Plinko Bounce game needs your attention. Please contact the PixelPlush team on Discord.")}function J(e,d,t,u,a){}function q(e,d,t,u,a){document.hidden}let B=null,D=368,W=0,G=0,X=null,Y=null,V=null,Q=0,H=0,K={},Z=null,ee={},de={},te={},ue=[],ae=[],oe=[],re=[],ie=null,se=null,ne=0,ce=0,fe=0,le=0;function me(e,d,t,u,a,o=""){le++;let r=Math.min(Math.max(1,a),100);Unicorn.AddParticles("Splash_"+le,{blendMode:PIXI.BLEND_MODES.DEFAULT,shape:"cone",angle:-Math.PI/2,spread:Math.PI/2,startColor:e,endColor:d,intensity:r,minSpeed:.05,maxSpeed:.25,gravityX:0,gravityY:3.5,fadeOut:!0,decay:1,image:o||void 0},t,u),function(e,d=2e3){setTimeout(()=>{Unicorn.RemoveParticles(e)},d)}("Splash_"+le,150)}function pe(e,d,t,u=""){const a=i.target_boosh_scale||2;i.target_boosh.forEach((t,u)=>{for(let t=0;t<v(5);t++){le++;let u=Unicorn.AddBacklay("boosh_"+le,"target_boosh"+t,e,d+10,{scale:{x:a,y:a}});u.zIndex=11,u.vX=v(50)-25,u.vY=-350+v(100),u.anchor.set(.5),ae.push(u)}})}function he(e,d,t,u=""){const a=i.target_splash_scale||2;i.target_splash.forEach((t,u)=>{for(let t=0;t<v(5);t++){le++;let u=Unicorn.AddBacklay("splash_"+le,"target_splash"+t,e,d+10,{scale:{x:a,y:a}});u.zIndex=11,u.vX=v(100)-50,u.vY=-300+v(100),u.anchor.set(.5),splashes.push(u)}})}async function ye(o,r,f="#ffffff",h,y="",g=""){let b=4/60;if(!ee[o]){ee[o]={};let x=null,S=null,w=null,U=tinycolor(f),$={};try{let e=await fetch(`${a}/accounts/twitch/design?username=${o}`).then(e=>e.json());e&&($=e.style||{})}catch(e){console.log(e)}if($.pet&&$.pet.id&&"pet_none"!==$.pet.id&&(i.pets||(i.pets={}),S=$.pet.id.replace("pet_",""),!i.pets[S])){i.pets[S]={path:$.pet.path,minIdle:$.pet.minIdle,maxIdle:$.pet.maxIdle};for(let e=0;e<m.NumFrames;e++){let d=$.pet.path+"_front";Unicorn.Load(d+e,`${n}/assets/pets/${S}/${d}/${d}${e+1}.png`)}}if(y){if(!de[y]){if(de[y]=!0,y.startsWith("emotesv2_")){let e=`https://static-cdn.jtvnw.net/emoticons/v2/${y}/default/dark/2.0`,d=await fetchGif(e);if(d.length>0){const e=function(e,d){const t=Math.min(...e.map(e=>e.delay)),u=Math.max(...e.map(e=>e.dims.width)),a=Math.max(...e.map(e=>e.dims.height)),o=u,r=a;let i=0;for(let r=0;r<e.length;r++){let s=document.createElement("canvas");s.width=u,s.height=a;let n=s.getContext("2d"),c=n.createImageData(u,a);if(1===e[r].disposalType){let d=r;for(let t=e[d].dims.top;t<a;t++)for(let a=e[d].dims.left;a<u;a++)t>=e[d].dims.top&&a>=e[d].dims.left&&t<e[d].dims.top+e[d].dims.height&&a<e[d].dims.left+e[d].dims.width&&e[d].pixels[t*o+a]!==e[d].transparentIndex?(c.data[t*o*4+4*a+0]=e[d].patch[t*o*4+4*a+0],c.data[t*o*4+4*a+1]=e[d].patch[t*o*4+4*a+1],c.data[t*o*4+4*a+2]=e[d].patch[t*o*4+4*a+2],c.data[t*o*4+4*a+3]=e[d].patch[t*o*4+4*a+3]):0===d&&(c.data[t*o*4+4*a+0]=e[0].patch[t*o*4+4*a+0],c.data[t*o*4+4*a+1]=e[0].patch[t*o*4+4*a+1],c.data[t*o*4+4*a+2]=e[0].patch[t*o*4+4*a+2],c.data[t*o*4+4*a+3]=e[0].patch[t*o*4+4*a+3])}else if(3===e[r].disposalType){let d=null;for(let t=0;t<=r;t++){for(let d=0;d<a;d++)for(let a=0;a<u;a++)if(d>=e[t].dims.top&&a>=e[t].dims.left&&d<e[t].dims.top+e[t].dims.height&&a<e[t].dims.left+e[t].dims.width){const u=(d-e[t].dims.top)*e[t].dims.width+(a-e[t].dims.left),r=(d-e[t].dims.top)*e[t].dims.width*4+4*(a-e[t].dims.left);e[t].pixels[u]!==e[t].transparentIndex?(c.data[d*o*4+4*a+0]=e[t].patch[r+0],c.data[d*o*4+4*a+1]=e[t].patch[r+1],c.data[d*o*4+4*a+2]=e[t].patch[r+2],c.data[d*o*4+4*a+3]=e[t].patch[r+3]):(c.data[d*o*4+4*a+0]=0,c.data[d*o*4+4*a+1]=0,c.data[d*o*4+4*a+2]=0,c.data[d*o*4+4*a+3]=0)}0===t&&(d=c.data.slice())}}else{let d=r;for(let t=e[d].dims.top;t<a;t++)for(let a=e[d].dims.left;a<u;a++){const u=(t-e[d].dims.top)*e[d].dims.width+(a-e[d].dims.left),r=(t-e[d].dims.top)*e[d].dims.width*4+4*(a-e[d].dims.left);t>=e[d].dims.top&&a>=e[d].dims.left&&t<e[d].dims.top+e[d].dims.height&&a<e[d].dims.left+e[d].dims.width&&e[d].pixels[u]!==e[d].transparentIndex&&(c.data[t*o*4+4*a+0]=e[d].patch[r+0],c.data[t*o*4+4*a+1]=e[d].patch[r+1],c.data[t*o*4+4*a+2]=e[d].patch[r+2],c.data[t*o*4+4*a+3]=e[d].patch[r+3])}}n.putImageData(c,0,0);for(let o=0;o<e[r].delay;o+=t)Unicorn.LoadCustom(`${d}${i}`,s,"texture",{width:u,height:a}),i++}return{frames:i,minDelay:t,width:o,height:r}}(d,"emote_"+y);de[y]={frames:e.frames,framerate:1/60*(1e3/e.minDelay)},setTimeout(()=>{delete ee[o],ye(o,r,f,h,y,g)},500)}else Unicorn.Load(`emote_${y}0`,e),setTimeout(()=>{delete ee[o],ye(o,r,f,h,y,g)},500)}else{let e=`https://static-cdn.jtvnw.net/emoticons/v1/${y}/2.0`;Unicorn.Load(`emote_${y}0`,e),setTimeout(()=>{delete ee[o],ye(o,r,f,h,y,g)},500)}return}let e=[];if(y.startsWith("emotesv2_")&&"boolean"!=typeof de[y]){b=de[y].framerate;for(let d=0;d<de[y].frames;d++)e.push(`emote_${y}${d}`)}else e=[`emote_${y}0`];x=Unicorn.AddObject("player_"+o,{type:"circle",scale:{x:1.2,y:1.2},animations:{front:{framerate:b,frames:e,loop:!0}},x:200+v(c-400),y:-100-v(50),z:100,radius:36,onCollide:(e,d,t)=>{if("TargetTop"===e){if(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_versions&&L(),i.target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_effect.length},(e,d)=>"target_effect"+d),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(Z&&i.target_versions[Z].target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_versions[Z].target_effect.length},(e,d)=>`target_effect${Z}${d}`),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(i.target_animate_on_landed&&L(2),i.target_particles&&me(i.target_particles[0],i.target_particles[1],ee[o].player.position.x,ee[o].player.position.y+40,10),i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),i.target_splash&&he(ee[o].player.position.x,ee[o].player.position.y+40),console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),s.messageFormat){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}}},onEnter:(e,d)=>{if("bottom_detect"===e&&(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),1*c/5+c/5-8<x.position.x&&x.position.x<2*c/5+c/5-8&&(console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),i.target_animate_star_on_landed&&fe++,s.messageFormat))){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}}}),x.charName="player_"+o,x.endImage="emote_"+y,x.endScale=1.2}else if(g){if(!te[g])return te[g]=!0,Unicorn.Load("emoji_"+g,g),void setTimeout(()=>{delete ee[o],ye(o,r,f,h,y,g)},500);x=Unicorn.AddObject("player_"+o,{type:"circle",scale:{x:1,y:1},animations:{front:{framerate:b,frames:["emoji_"+g],loop:!0}},x:200+v(c-400),y:-100-v(50),z:100,radius:36,onCollide:(e,d,t)=>{if("TargetTop"===e){if(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_versions&&L(),i.target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_effect.length},(e,d)=>"target_effect"+d),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(Z&&i.target_versions[Z].target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_versions[Z].target_effect.length},(e,d)=>`target_effect${Z}${d}`),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(i.target_animate_on_landed&&L(2),i.target_particles&&me(i.target_particles[0],i.target_particles[1],ee[o].player.position.x,ee[o].player.position.y+40,10),i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),i.target_splash&&he(ee[o].player.position.x,ee[o].player.position.y+40),console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),s.messageFormat){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}}},onEnter:(e,d)=>{if("bottom_detect"===e&&(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),1*c/5+c/5-8<x.position.x&&x.position.x<2*c/5+c/5-8&&(console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),i.target_animate_star_on_landed&&fe++,s.messageFormat))){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}}}),x.charName="player_"+o,x.endImage="emoji_"+g,x.endScale=1}else{if(x="string"==typeof h?function(u,a,o,r,s=null){i.playable,e++;const n="player_"+e;if(!i)throw"No GameTheme Defined";i.characters||(i.characters={});let c=!1;s&&i.playable.includes(s)||(r.character&&r.character.id?(s=r.character.id,c=!0):s=i.playable[v(i.playable.length)]),p[s]||(i.characters[s]=c?r.character.path:s,A(s,"characters",i.characters[s],m.NumFrames));let f=t({x:u,y:a,z:o,radius:36,name:n,animations:d(s,m.NumFrames)});return f.character=s,f.charName=n,f.endImage=s+"_front0",f.endScale=3,f}(v(c),-100-v(50),100,$,h):function(a,o,r,s={}){e++;const n="player_"+e;if(!i)throw"No GameTheme Defined";let c=m.NumFrames,f="",l={};if(s.character){const e=s.character;p[e]||(i.characters[e]=e,A(e,"characters",i.characters[e],c)),l=t({x:a,y:o,z:r,radius:36,name:n,animations:d(e,c)}),l.character=e,l.charName=n,l.endImage=e+"_front0",l.endScale=3,l.sprites={}}else{if(s.equipment){const e=Object.keys(s.equipment);if(e.length>0){const d=e[0],t=s.equipment[d];c=1,f="_wheel",A(t,"skins/equipment/"+d,t,m.NumFrames)}}if(!s.body||!s.body.skintones)throw"No Body";{const e=s.body.skintones,i=s.body.expressions,m=s.body.hair;A(e,"skins/body/skintones",e,c,f),l=t({x:a,y:o,z:r,radius:36,name:n,animations:d(e,c),suffix:f}),l.character=e,l.charName=n,l.endImage=e+"_front0",l.endScale=3,l.sprites={},A(i,"skins/body/expressions",i,c,f),l.sprites.expr=u({x:a,y:o,z:r+1,name:n+"_expr",animations:d(i,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_expr",n),A(m,"skins/body/hair",m,c,f),l.sprites.hair=u({x:a,y:o,z:r+2,name:n+"_hair",animations:d(m,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_hair",n)}if(s.equipment){const e=Object.keys(s.equipment);if(e.length>0){const t=e[0],i=s.equipment[t];l.sprites.eq=u({x:a,y:o,z:r+10,name:n+"_eq",animations:d(i,m.NumFrames)}),Unicorn.AttachSpriteToObject(n+"_eq",n)}}}if(s.outfits){const e=s.outfits.pants,t=s.outfits.shirts,i=s.outfits.dresses;e&&(A(e,"skins/outfits/pants",e,c,f),l.sprites.pants=u({x:a,y:o,z:r+3,name:n+"_pants",animations:d(e,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_pants",n)),t&&(A(t,"skins/outfits/shirts",t,c,f),l.sprites.shirts=u({x:a,y:o,z:r+4,name:n+"_shirts",animations:d(t,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_shirts",n)),i&&(A(i,"skins/outfits/dresses",i,c,f),l.sprites.dresses=u({x:a,y:o,z:r+5,name:n+"_dresses",animations:d(i,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_dresses",n))}if(s.accessories)for(const e in s.accessories){const t=s.accessories[e];A(t,"skins/accessories/"+e,t,c,f),l.sprites["acc_"+t]=u({x:a,y:o,z:r+10,name:n+"_acc_"+t,animations:d(t,c),suffix:f}),Unicorn.AttachSpriteToObject(n+"_acc_"+t,n)}return l}(v(c),-100-v(50),100,h),x.onCollide=(e,d,t)=>{if("TargetTop"===e){if(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_versions&&L(),i.target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_effect.length},(e,d)=>"target_effect"+d),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(Z&&i.target_versions[Z].target_effect){M++;const e="te_"+M;let d=Unicorn.AddObject(e,{type:"circle",scale:{x:2,y:2},animations:{front:{framerate:4/60,frames:Array.from({length:i.target_versions[Z].target_effect.length},(e,d)=>`target_effect${Z}${d}`),loop:!1,onComplete:()=>{Unicorn.RemoveObject(e)}}},isSensor:!0,isStatic:!0,x:ee[o].player.position.x,y:ee[o].player.position.y,z:200,radius:.1});d.isSensor=!0,d.animations.front.anchor.y=1}if(i.target_animate_on_landed&&L(2),i.target_particles&&me(i.target_particles[0],i.target_particles[1],ee[o].player.position.x,ee[o].player.position.y+40,10),i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),i.target_splash&&he(ee[o].player.position.x,ee[o].player.position.y+40),console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),s.messageFormat){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}}},detectEnter[x.charName]=(e,d)=>{if("bottom_detect"===e&&(ee[o].isLanded=!0,x.collisionFilter.category=1,x.isSensor=!0,x.isStatic=!0,i.target_boosh&&pe(ee[o].player.position.x,ee[o].player.position.y+40),1*c/5+c/5-8<x.position.x&&x.position.x<2*c/5+c/5-8&&(console.log("Winner: "+o),Unicorn.PlaySound("sfx-win",{volume:l}),i.target_animate_star_on_landed&&fe++,s.messageFormat))){let e=s.messageFormat.replace("USERNAME",o);setTimeout(()=>{ComfyJS.Say(e)},5e3)}},"boybear"===h||"girlbear"===h){var _=PIXI.utils.string2hex(U.brighten(50).toHexString());x.animations.front.tint=_}if(S){let e={front:[]};for(let d=0;d<m.NumFrames;d++)Object.keys(e).forEach(t=>{e[t].push(i.pets[S].path+"_"+t+d)});w=Unicorn.AddObject("pet_"+o,{type:"circle",scale:{x:3,y:3},animations:{front:{framerate:b,frames:e.front,loop:!0}},x:-1e3,y:-1e3,z:200,radius:24,isStatic:!0}),w.isSensor=!0,w.charName="pet_"+o}}let k=Unicorn.AddText("name_"+o,r,-1e3,-1e3,{fontFamily:"Pixeltype",fontSize:40,fontWeight:"bold",fill:f,lineJoin:"round",stroke:tinycolor.isReadable(U.toString(),"#000000")?"#000000":"#ffffff",strokeThickness:6});k.anchor.set(.5),x.rotationOffset=Math.random()*Math.PI,ee[o]={player:x,label:k,pet:w,petType:S,petOffset:50*Math.random()-25},B&&clearTimeout(B),B=setTimeout(()=>{location.reload()},parseInt(s.cooldown||9e4))}}function ge(){if(PIXI.settings.SCALE_MODE=PIXI.SCALE_MODES.NEAREST,Unicorn.Load("map",`${n}/assets/${i.bg}.png`),!s.overlay){var e=Unicorn.AddBacklay("map","map",0,f-1080);e.scale.x=3,e.scale.y=3}if(i.target_versions)Object.keys(i.target_versions).forEach(e=>{let d=i.target_versions[e];if(Array.isArray(d.target)){d.target.map((d,t)=>Unicorn.Load("target"+e+t,`${n}/assets/${d}.png`))}else{Unicorn.Load("target"+e,`${n}/assets/${d.target}.png`)}if(Array.isArray(d.target_overlay)){d.target_overlay.map((d,t)=>Unicorn.Load("target_overlay"+e+t,`${n}/assets/${d}.png`))}else{Unicorn.Load("target_overlay"+e,`${n}/assets/${d.target_overlay}.png`)}if(d.target_effect){d.target_effect.map((d,t)=>Unicorn.Load("target_effect"+e+t,`${n}/assets/${d}.png`))}});else if(i.target){if(Array.isArray(i.target)){i.target.map((e,d)=>Unicorn.Load("target"+d,`${n}/assets/${e}.png`))}else{Unicorn.Load("target",`${n}/assets/${i.target}.png`)}if(Array.isArray(i.target_overlay)){i.target_overlay.map((e,d)=>Unicorn.Load("target_overlay"+d,`${n}/assets/${e}.png`))}else{Unicorn.Load("target_overlay",`${n}/assets/${i.target_overlay}.png`)}if(i.target_effect){i.target_effect.map((e,d)=>Unicorn.Load("target_effect"+d,`${n}/assets/${e}.png`))}}i.target_front&&Unicorn.Load("target_front",`${n}/assets/${i.target_front}.png`),i.target_boosh&&i.target_boosh.forEach((e,d)=>{Unicorn.Load("target_boosh"+d,`${n}/assets/${e}.png`)}),i.target_splash&&i.target_splash.forEach((e,d)=>{Unicorn.Load("target_splash"+d,`${n}/assets/${e}.png`)}),i.wall&&Unicorn.Load("wall",`${n}/assets/${i.wall}.png`),i.wallfront&&Unicorn.Load("wallfront",`${n}/assets/${i.wallfront}.png`),Array.isArray(i.peg)?i.peg.forEach((e,d)=>{Unicorn.Load("peg"+d,`${n}/assets/${e}.png`)}):Unicorn.Load("peg",`${n}/assets/${i.peg}.png`),Array.isArray(i.star)?i.star.forEach((e,d)=>{Unicorn.Load("star"+d,`${n}/assets/${e}.png`)}):Unicorn.Load("star",`${n}/assets/${i.star}.png`),Object.keys(i.characters).forEach(e=>{A(e,"characters",i.characters[e],m.NumFrames)}),i.clouds.forEach(e=>Unicorn.Load(e,`${n}/assets/${e}.png`)),s.notifVolume&&Unicorn.Load("sfx-group-queue",`${n}/assets/${i.queue_sound}`),Unicorn.Load("sfx-peg-bounce",`${n}/assets/${i.peg_sound}`),Unicorn.Load("sfx-win",`${n}/assets/${i.win_sound}`);for(let e=0;e<4;e++){let d,t,u;e%2==0?(d=Math.floor(c/137),t=c/d,u=t,d--):(d=Math.floor((c-137)/137),d--,t=137,u=137+t/2);for(let a=0;a<d;a++){let d="peg";Array.isArray(i.peg)&&(d="peg"+(a+2*e)%i.peg.length);let o=Unicorn.AddObject(`peg_${e}-${a}`,{type:"circle",x:a*t+u,y:f-240-200*e,radius:27,scale:{x:3,y:3},sprite:d,isStatic:!0,density:1/0,friction:1,frictionStatic:.5,frictionAir:.01,onEnter:(e,d)=>{e.startsWith("player_")&&Unicorn.PlaySound("sfx-peg-bounce",{volume:l})}});o.sprite.alpha=s.overlay?.15:1,o.restitution=1.05,o.mass=1/0,o.inverseMass=0,oe.push(o)}}if(!i.hideWalls){for(let e=0;e<4;e++){let d=Unicorn.AddObject("wall_"+e,{type:"rectangle",x:e*c/5+c/5-8,y:f-60,width:12,height:120,scale:{x:3,y:3},sprite:"wall",isStatic:!0});re.push(d)}i.wallfront&&(ie=Unicorn.AddBacklay("wallfront","wallfront",0,f-1080),ie.scale.x=c/1920*3,ie.scale.y=3)}Unicorn.AddObject("bottom_detect",{type:"rectangle",x:c/2,y:f-2,width:c,height:2,isStatic:!0,isSensor:!0}).sprite.visible=!1;let d=Unicorn.AddObject("left_bound",{type:"rectangle",x:-100,y:f/2,width:200,height:f,isStatic:!0});d.restitution=1.05,d.mass=1/0,d.inverseMass=0,d.sprite.visible=!1;let t=Unicorn.AddObject("right_bound",{type:"rectangle",x:c+100,y:f/2,width:200,height:f,isStatic:!0});if(t.restitution=1.05,t.mass=1/0,t.inverseMass=0,t.sprite.visible=!1,Array.isArray(i.star)){ne=0,se=[];for(let e=0;e<i.star.length;e++){let d=Unicorn.AddBacklay("star"+e,"star"+e,c/2+(i.starXOffset||0),f-80+(i.starYOffset||0),{scale:{x:3,y:3}});d.anchor.set(.5),d.visible=!i.hideWalls,se.push(d)}for(let e=0;e<i.star.length;e++)se[e].visible=!1;se[ne].visible=!0}else se=Unicorn.AddBacklay("star","star",c/2+(i.starXOffset||0),f-80+(i.starYOffset||0),{scale:{x:3,y:3}}),se.anchor.set(.5),se.visible=!i.hideWalls;Matter.Events.on(physics,"beforeUpdate",(function(e){for(var d in ee)ee[d].player&&Matter.Body.setVelocity(ee[d].player,{x:Math.max(Math.min(ee[d].player.velocity.x,30),-30),y:Math.max(Math.min(ee[d].player.velocity.y,30),-30)})}))}function be(e,d){for(var t in ee)ee[t].player&&(ee[t].isLanded,ee[t].label.position.x=ee[t].player.position.x,ee[t].label.position.y=ee[t].player.position.y-60,ee[t].pet&&(ee[t].pet.angle=ee[t].player.angle,ee[t].pet.position.x=Math.max(20,Math.min(c-20,ee[t].player.position.x+ee[t].petOffset)),ee[t].pet.position.y=ee[t].player.position.y+20));ue.forEach((e,t)=>{e.x-=d*e.speed,e.x+e.width/2<=0&&(e.x=c+e.width/2,e.y=v(500),e.speed=.01+.1*Math.random(),e.zIndex=e.speed)}),ae.forEach(e=>{(e.vY<0||e.y<f-5)&&(e.x+=d/1e3*e.vX,e.y+=d/1e3*e.vY,e.vY<20&&(e.vY+=d/1e3*200))}),fe>0&&Array.isArray(i.star)&&(ce-=d,ce<=0&&(ce+=60,se[ne].visible=!1,ne=(ne+1)%se.length,se[ne].visible=!0,i.target_animate_star_on_landed&&0===ne&&fe--))}